<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MusicSchool Colombia</title>
  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
  <!-- Estilos globales: forzar recarga con versionado -->
  <link rel="stylesheet" href="/static/styles.css?v=1" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üéµ</text></svg>">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container header__inner">
      <div class="brand">
        <img class="brand__logo" alt="Logo" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 24 24'%3E%3Ctext y='18' x='2' font-size='18'%3E%F0%9F%8E%B5%3C/text%3E%3C/svg%3E"/>
        <span>MusicSchool Colombia</span>
      </div>
      <nav class="nav" role="navigation" aria-label="principal">
        <a class="active" href="/">Inicio</a>
        <a href="#cursos">Cursos</a>
        <a href="/admin/">Dashboard</a>
        <a href="mailto:info@musicschool.co">Contacto</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container hero__grid">
      <div>
        <h1>Aprende M√∫sica Online</h1>
        <p>Cursos profesionales de m√∫sica en l√≠nea, presenciales e h√≠bridos. Mejora tu t√©cnica con instructores expertos.</p>
        <div class="hero__cta">
          <a class="btn btn--primary" href="#cursos">Explorar Cursos</a>
          <a class="btn btn--ghost" href="/api/">Ver API</a>
        </div>
      </div>
      <div>
        <img alt="Ilustraci√≥n musical" loading="lazy" src="https://images.unsplash.com/photo-1511379938547-c1f69419868d?q=80&w=1200&auto=format&fit=crop" style="border-radius: 18px; box-shadow: var(--shadow-lg);" />
      </div>
    </div>
  </section>

  <!-- Beneficios -->
  <section class="section">
    <div class="container">
      <div class="benefits">
        <article class="benefit">
          <h3>Instructores Expertos</h3>
          <p>Aprende de profesionales con experiencia comprobada en escenario y docencia.</p>
        </article>
        <article class="benefit">
          <h3>Modalidades Flexibles</h3>
          <p>Clases online, presenciales o h√≠bridas seg√∫n tu disponibilidad.</p>
        </article>
        <article class="benefit">
          <h3>Contenido de Calidad</h3>
          <p>Lecciones estructuradas, materiales descargables y soporte continuo.</p>
        </article>
      </div>
    </div>
  </section>

  <!-- Cursos Destacados -->
  <section id="cursos" class="section" aria-labelledby="cursos-title">
    <div class="container">
      <div class="courses__header">
        <h2 id="cursos-title" style="margin:0">Cursos Destacados</h2>
        <div>
          <select id="order" aria-label="Ordenar" style="padding:8px 12px; border-radius:10px; border:1px solid #e5eef7;">
            <option value="-created_at">Nuevos</option>
            <option value="-rating">Mejor calificados</option>
            <option value="price">Precio: menor a mayor</option>
            <option value="-price">Precio: mayor a menor</option>
          </select>
        </div>
      </div>
      <div id="courses-grid" class="courses__grid" aria-live="polite"></div>
    </div>
  </section>

  <!-- Testimonios -->
  <section class="section section-sm" aria-labelledby="testi-title">
    <div class="container">
      <h2 id="testi-title" class="center" style="margin-top:0">Lo que dicen nuestros estudiantes</h2>
      <div class="testimonials">
        <article class="testimonial">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p>‚ÄúPas√© de nivel principiante a tocar mis primeras piezas en piano en pocas semanas.‚Äù</p>
          <strong>Laura G.</strong>
        </article>
        <article class="testimonial">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p>‚ÄúLa metodolog√≠a es clara, los instructores son muy pro y el material complementario ayuda bastante.‚Äù</p>
          <strong>Carlos M.</strong>
        </article>
      </div>
    </div>
  </section>

  <!-- CTA final -->
  <section class="section" style="padding-top:0">
    <div class="container center">
      <h2 style="margin:0 0 12px">¬øListo para comenzar?</h2>
      <p style="margin:0 0 24px;color:var(--text-500)">Explora nuestro cat√°logo y encuentra el curso ideal para ti.</p>
      <a class="btn btn--primary" href="#cursos">Comenzar ahora</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container footer__inner">
      <div>
        <h3 style="margin-top:0;color:#e2e8f0">MusicSchool Colombia</h3>
        <p style="margin:0;color:#94a3b8">Aprende con los mejores, a tu ritmo y desde cualquier lugar.</p>
      </div>
      <div>
        <h4 style="margin-top:0;color:#e2e8f0">Enlaces</h4>
        <ul style="list-style:none; padding:0; margin:0; color:#cbd5e1">
          <li><a href="/admin/">Panel Admin</a></li>
          <li><a href="/api/">API</a></li>
          <li><a href="#cursos">Cursos</a></li>
        </ul>
      </div>
      <div>
        <h4 style="margin-top:0;color:#e2e8f0">Contacto</h4>
        <p style="margin:0;color:#cbd5e1">info@musicschool.co</p>
      </div>
    </div>
    <div class="footer__bottom">
      ¬© <span id="year"></span> MusicSchool Colombia. Todos los derechos reservados.
    </div>
  </footer>

  <script>
    // A√±o din√°mico
    document.getElementById('year').textContent = new Date().getFullYear();

    const grid = document.getElementById('courses-grid');
    const selectOrder = document.getElementById('order');

    function formatPrice(num) {
      try { return new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP' }).format(Number(num)); } catch { return num; }
    }

    function courseCard(course) {
      const hasDiscount = (course.discount_percentage || 0) > 0;
      const oldPrice = hasDiscount ? `<span class=\"old\">${formatPrice(course.price)}</span>` : '';
      const discounted = hasDiscount ? Number(course.price) * (1 - Number(course.discount_percentage) / 100) : Number(course.price);
      const nowPrice = `<span class=\"now\">${formatPrice(discounted)}</span>`;
      const thumb = course.thumbnail_url || 'https://images.unsplash.com/photo-1513885535751-8b9238bd3456?q=80&w=1200&auto=format&fit=crop';

      return `
        <article class=\"card\" role=\"article\">
          <div class=\"card__thumb\">
            <img alt=\"${course.title}\" src=\"${thumb}\" loading=\"lazy\" />
            ${hasDiscount ? `<div class=\"badge\">-${course.discount_percentage}%</div>` : ''}
          </div>
          <div class=\"card__body\">
            <h3 class=\"card__title\">${course.title}</h3>
            <div class=\"meta\">
              <span>‚è± ${course.duration_weeks || 0} semanas</span>
              <span>üéº ${course.level}</span>
              <span>‚≠ê ${course.rating || 5}</span>
            </div>
            <div class=\"price\">${oldPrice}${nowPrice}</div>
          </div>
        </article>
      `;
    }

    async function loadCourses(ordering = '-created_at') {
      grid.innerHTML = '<div class="center" style="grid-column:1/-1;color:var(--text-500)">Cargando cursos‚Ä¶</div>';
      try {
        const res = await fetch(`/api/courses/?ordering=${encodeURIComponent(ordering)}`);
        const data = await res.json();
        if (!Array.isArray(data) || data.length === 0) {
          grid.innerHTML = '<div class="center" style="grid-column:1/-1;color:var(--text-500)">No hay cursos disponibles por ahora.</div>';
          return;
        }
        grid.innerHTML = data.map(courseCard).join('');
      } catch (e) {
        grid.innerHTML = '<div class="center" style="grid-column:1/-1;color:crimson">Error cargando cursos.</div>';
      }
    }

    selectOrder.addEventListener('change', (e) => loadCourses(e.target.value));
    loadCourses(selectOrder.value);
  </script>
</body>
</html>
